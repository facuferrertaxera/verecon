<mvc:View controllerName="tech.taxera.taxreporting.verecon.controller.ReconciliationDetail"
    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"
    xmlns="sap.m"
    xmlns:smartform="sap.ui.comp.smartform"
    xmlns:smartField="sap.ui.comp.smartfield"
    xmlns:form="sap.ui.layout.form"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core"
    xmlns:layout="sap.ui.layout"
    xmlns:cssgrid="sap.ui.layout.cssgrid"
    xmlns:smartTable="sap.ui.comp.smarttable"
    xmlns:smartFilterBar="sap.ui.comp.smartfilterbar" 
    xmlns:table="sap.ui.table"
    xmlns:m="sap.m"
    xmlns:smartVariant="sap.ui.comp.smartvariants.SmartVariantManagement"
    xmlns:mc="sap.suite.ui.microchart"
    xmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">
    <f:DynamicPage headerExpanded="{view>/reconciliationDetail/headerExpanded}" toggleHeaderOnTitleClick="{view>/reconciliationDetail/titleClickable}" class="sapUiNoContentPadding">
        <!-- DynamicPage Header -->
        <f:header>
            <f:DynamicPageHeader pinnable="true">
                <f:content>
                    <!-- Charts for reconciliation overview -->
                    <cssgrid:CSSGrid
                        gridTemplateColumns="repeat(12, 1fr)"
                        gridGap="1.5rem"
                        width="100%"
                        class="sapUiNoContentPadding sapUiSmallMarginBeginEnd"
                        visible="{view>/reconciliationDetail/chartFiltersVisible}">
                        
                        <!-- Reconciliation Details Card -->
                        <f:Card class="sapUiNoContentPadding">
                            <f:layoutData>
                                <cssgrid:GridItemLayoutData gridColumn="span 3" />
                            </f:layoutData>
                            <f:content>
                                <VBox class="sapUiMediumMargin">
                                    <Title text="{i18n>reconciliationDetail.ReconciliationDetails}" titleStyle="H4" class="sapUiSmallMarginBottom" />
                                    <VBox class="sapUiSmallMarginBottom">
                                        <Label text="{i18n>reconciliationList.CountryList}" class="sapUiTinyMarginBottom" design="Bold" />
                                        <Tokenizer id="reconciliationCountryListTokenizer" editable="false" width="100%" multiLine="true" class="sapUiTinyMarginTop"/>
                                    </VBox>
                                    <VBox class="sapUiSmallMarginBottom">
                                        <Label text="{i18n>reconciliationList.CompanyCodeList}" class="sapUiTinyMarginBottom" design="Bold" />
                                        <Tokenizer id="reconciliationCompanyCodeListTokenizer" editable="false" width="100%" multiLine="true" class="sapUiTinyMarginTop"/>
                                    </VBox>
                                    <VBox>
                                        <Label text="{i18n>reconciliationDetail.DateRange}" class="sapUiTinyMarginBottom" design="Bold" />
                                        <Text text="{path: 'FromDate', type: '.types.TaxeraDateType'} - {path: 'ToDate', type: '.types.TaxeraDateType'}" class="sapUiTinyMarginTop" />
                                    </VBox>
                                </VBox>
                            </f:content>
                        </f:Card>
                        
                        <!-- Document Types per Country Chart Card -->
                        <f:Card class="sapUiNoContentPadding">
                            <f:layoutData>
                                <cssgrid:GridItemLayoutData gridColumn="span 4" />
                            </f:layoutData>
                            <f:content>
                                <VBox class="sapUiMediumMargin">
                                    <Title text="{i18n>reconciliationDetail.DocTypesPerCountry}" titleStyle="H4" class="sapUiSmallMarginBottom" />
                                    <mc:InteractiveBarChart
                                        id="documentTypeBarChart"
                                        labelWidth="30%"
                                        selectionChanged="onSelectDocumentTypeFilter"
                                        showError="{view>/reconciliationDetail/bChartShowError}"
                                        displayedBars="4"
                                        bars="{ 
                                            path : 'view>/reconciliationDetail/headerFilters/documentTypeBarChart/bars' , factory: '.createBars'
                                        }"
                                    />
                                </VBox>
                            </f:content>
                        </f:Card>
                        
                        <!-- Submitted Documents per Month Chart Card -->
                        <f:Card class="sapUiNoContentPadding">
                            <f:layoutData>
                                <cssgrid:GridItemLayoutData gridColumn="span 5" />
                            </f:layoutData>
                            <f:content>
                                <VBox class="sapUiMediumMargin" height="180px">
                                    <Title text="{i18n>reconciliationDetail.SubmittedDocumentsPerMonth}" titleStyle="H4" class="sapUiSmallMarginBottom" />
                                    <mc:InteractiveLineChart 
                                        id="submissionDateLineChart" 
                                        selectionChanged="onSelectSubmittedMonthFilter" 
                                        showError="{view>/reconciliationDetail/bChartShowError}" 
                                        points="{ path : 'view>/reconciliationDetail/headerFilters/submissionDateLineChart/points' , factory: '.createPoints'}" />
                                </VBox>
                            </f:content>
                        </f:Card>
                        
                    </cssgrid:CSSGrid>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <VBox class="sapUiMediumMargin">
                <table:Table
                    id="documentsTable"
                    enableColumnFreeze="true"
                    visibleRowCountMode="Auto"
                    selectionMode="None"
                    class="sapUiNoContentPadding">
                    <table:extension>
                        <OverflowToolbar style="Clear" class="sapUiMediumMarginBottom">
                            <Title text="{i18n>reconciliationDetail.Documents}" titleStyle="H3"/>
                        </OverflowToolbar>
                    </table:extension>
                <table:columns>
                    <table:Column width="8rem" sortProperty="CompanyCode" filterProperty="CompanyCode">
                        <m:Label text="{i18n>reconciliationDetail.CompanyCode}" textAlign="Center" width="100%"/>
                        <table:template>
                            <m:Text text="{CompanyCode}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="10rem" sortProperty="DocumentNo" filterProperty="DocumentNo">
                        <m:Label text="{i18n>reconciliationDetail.DocumentNo}" textAlign="Center" width="100%"/>
                        <table:template>
                            <m:Text text="{DocumentNo}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="6rem" sortProperty="FiscalYear" filterProperty="FiscalYear">
                        <m:Label text="{i18n>reconciliationDetail.FiscalYear}" textAlign="Center" width="100%"/>
                        <table:template>
                            <m:Text text="{FiscalYear}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="10rem" sortProperty="PostingDate" filterProperty="PostingDate">
                        <m:Label text="{i18n>reconciliationDetail.PostingDate}" textAlign="Center" width="100%"/>
                        <table:template>
                            <m:Text text="{path: 'PostingDate', type: 'sap.ui.model.type.Date', formatOptions: {style: 'medium'}}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="8rem" sortProperty="TaxCode" filterProperty="TaxCode">
                        <m:Label text="{i18n>reconciliationDetail.TaxCode}" textAlign="Center" width="100%"/>
                        <table:template>
                            <m:Text text="{TaxCode}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="6rem" sortProperty="Currencycode" filterProperty="Currencycode">
                        <m:Label text="{i18n>reconciliationDetail.Currency}" textAlign="Center" width="100%"/>
                        <table:template>
                            <m:Text text="{Currencycode}"/>
                        </table:template>
                    </table:Column>
                    <!-- VATR Column Group - spans 3 columns -->
                    <table:Column width="8rem" sortProperty="VatrBaseAmount" filterProperty="VatrBaseAmount" headerSpan="3,2">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.VATR}" textAlign="Center" width="100%"/>
                            <m:Label text="{i18n>reconciliationDetail.BaseAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{VatrBaseAmount}" unit="{Currencycode}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="8rem" sortProperty="VatrTaxAmount" filterProperty="VatrTaxAmount" headerSpan="2">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.VATR}"/>
                            <m:Label text="{i18n>reconciliationDetail.TaxAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{VatrTaxAmount}" unit="{Currencycode}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="8rem" sortProperty="VatrGrossAmount" filterProperty="VatrGrossAmount">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.VATR}"/>
                            <m:Label text="{i18n>reconciliationDetail.GrossAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{VatrGrossAmount}" unit="{Currencycode}"/>
                        </table:template>
                    </table:Column>
                    <!-- ECSL Column Group - spans 3 columns -->
                    <table:Column width="8rem" sortProperty="EcslBaseAmount" filterProperty="EcslBaseAmount" headerSpan="3,2">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.ECSL}" textAlign="Center" width="100%"/>
                            <m:Label text="{i18n>reconciliationDetail.BaseAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{EcslBaseAmount}" unit="{Currencycode}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="8rem" sortProperty="EcslTaxAmount" filterProperty="EcslTaxAmount" headerSpan="2">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.ECSL}"/>
                            <m:Label text="{i18n>reconciliationDetail.TaxAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{EcslTaxAmount}" unit="{Currencycode}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="8rem" sortProperty="EcslGrossAmount" filterProperty="EcslGrossAmount">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.ECSL}"/>
                            <m:Label text="{i18n>reconciliationDetail.GrossAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{EcslGrossAmount}" unit="{Currencycode}"/>
                        </table:template>
                    </table:Column>
                    <!-- Differences Column Group - spans 3 columns -->
                    <table:Column width="8rem" sortProperty="DiffBaseAmount" filterProperty="DiffBaseAmount" headerSpan="3,2">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.Differences}" textAlign="Center" width="100%"/>
                            <m:Label text="{i18n>reconciliationDetail.BaseAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{DiffBaseAmount}" unit="{Currencycode}" state="{path: 'DiffBaseAmount', formatter: '.formatter.formatDiffAmountState'}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="8rem" sortProperty="DiffTaxAmount" filterProperty="DiffTaxAmount" headerSpan="2">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.Differences}"/>
                            <m:Label text="{i18n>reconciliationDetail.TaxAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{DiffTaxAmount}" unit="{Currencycode}" state="{path: 'DiffTaxAmount', formatter: '.formatter.formatDiffAmountState'}"/>
                        </table:template>
                    </table:Column>
                    <table:Column width="8rem" sortProperty="DiffGrossAmount" filterProperty="DiffGrossAmount">
                        <table:multiLabels>
                            <m:Label text="{i18n>reconciliationDetail.Differences}"/>
                            <m:Label text="{i18n>reconciliationDetail.GrossAmount}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectNumber number="{DiffGrossAmount}" unit="{Currencycode}" state="{path: 'DiffGrossAmount', formatter: '.formatter.formatDiffAmountState'}"/>
                        </table:template>
                    </table:Column>
                    <!-- Status Column -->
                    <table:Column width="8rem" sortProperty="Status" filterProperty="Status">
                        <table:multiLabels>
                            <m:Label visible="false"/>
                            <m:Label text="{i18n>reconciliationDetail.Status}" textAlign="Center" width="100%"/>
                        </table:multiLabels>
                        <table:template>
                            <m:ObjectStatus text="{Status}" state="{path: 'Status', formatter: '.formatter.formatStatusColor'}"/>
                        </table:template>
                    </table:Column>
                </table:columns>
            </table:Table>
            </VBox>
        </f:content>
    </f:DynamicPage>
</mvc:View>
